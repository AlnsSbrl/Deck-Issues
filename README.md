# Deck Issues
Es un juego de cartas de la baraja española para Nintendo 3DS desarrollado con DevKitPro en C/C++.
## Instalación
Existen dos opciones para poder jugar al juego:
- >Se necesita un emulador de 3DS como [Citra](https://citra-emu.org/). Tras instalar y ejecutar el emulador, simplemente se abre el archivo `.3dsx`.
- >De querer jugar en una consola, esta tendría que haber sido modificada siguiendo [estos pasos](https://3ds.hacks.guide/). Tras ello se pone el archivo `.3dsx` en la tarjeta SD en la carpeta `/3ds`. Tras insertar la SD de nuevo en la consola, se podrá abrir el juego accediendo a él desde el `homebrew launcher`.
- >En el caso de querer modificar el juego, es necesario descargarse las librerías de [DevKitPro](https://devkitpro.org/wiki/Getting_Started). Configurando el IDE para detectar dependencias, se podrán modificar los archivos C/C++ en `source` o los sprites que se emplean en `gfx`, sin olvidar que hay que incluirlos en `gfx\sprites.t3s`. Para compilar el proyecto y generar los archivos para poder jugarlo es necesario usar la `cmd`, situarnos en la carpeta del proyecto y ejecutar el comando `make`. Si todo funciona correctamente se generarán los archivos necesarios, incluido el archivo `.3dsx` que es el empleado para propiamente jugar al juego. 

## Contenido
Ahora mismo el juego solo dispone de una pantalla. Al abrir el juego se reparten las cartas y se colocan en la pantalla superior ocultándolas, si son de la futura IA, o en la pantalla inferior mostrando su valor, si son las del jugador. En todo momento se aseguran que las cartas repartidas no se repiten.

## Actualizaciones: 

(12/04) La jugabilidad no ha cambiado en absoluto. Se ha modularizado completamente el proyecto en clases siguiendo el estándar de C++, separando las clases en headers y en archivos cpp. Se han creado los métodos básicos que seguirán las clases dentro del juego y se ha modificado el mainLoop del juego para detectar cuándo se toca una carta, en teoría dándole la vuelta, ~~pero esto sólo se comprobará si funciona cuando se arreglen los errores de compilación~~ :)

(21/04) Se creó la rama [Debug Changes](https://github.com/AlnsSbrl/Deck-Issues/tree/debug-changes) para situar un proyecto de consola en Visual Studio que se usará para encontrar errores de lógica.

(23/04) Se hicieron cambios en las clases Jugador y Partida, así como los métodos usados al repartir cartas para asegurar que cada jugador tiene 3 cartas y que éstas son las mismas (mismo objeto) que las que están en la colección de cartas repartidas en la partida. Estos cambios fueron introducidos porque tras la modularización en distintas clases no se pueden apreciar las cartas en pantalla, como sí ocurría en el primer commit. Estos cambios parecen no haber afectado en el resultado.

(27/04) Tras haber averiguado que los bugs que impedían ver algo por pantalla al ejecutar el archivo `.3dsx` se debían a una fórmula y un bucle mal hechos, se ha seguido con el desarrollo de las clases del juego. Se ha introducido la clase base `InputHandler`, que tiene funciones para las distintas combinaciones de teclas que se pretenden emplear en todo el juego. También se ha creado la clase base `Escena`, que tendrá los contenidos que se quieran representar en esa escena a su disposición. Cada escena tendrá su inputhandler y se aprovechará el polimorfismo para poder ir cambiando de escenas y de mapeos de botones con facilidad.

(02/05) Se han creado dos escenas y dos inputhandlers con el objetivo de tener una pantalla principal que al clickarla (o al pulsar `A` o `START`) nos lleve a una escena donde se repartan las cartas. En esta escena si se pulsa `START` se volverían a repartir las cartas, mientras que si se pulsa `B` se volvería a la pantalla principal. Esta sería la versión para comprobar la funcionalidad básica del juego, pero por un despiste con los includes no se ha podido generar el archivo `.3dsx` para probarlo (la clase `Escena` incluye a `Inputhandler`...pero `Inputhandler` a la vez también incluye a `Escena`...:thumbsup::thumbsup:)

(02/05 v2.0 electric boogaloo) Se han expandido las clases que componen el bucle principal del juego, haciendo que los botones del handler avancen la escena, haciendo que cada vez que el usuario presione el botón `A` en la escena de la partida, la IA que tenga el turno realice su acción, mientras que si es el turno del jugador no hace nada. En cambio, si el jugador presiona sobre alguna carta la jugaría ~~suponiendo que el onTouch() funcione~~ si y solo si es su turno de jugar, aunque también podría usar las teclas de dirección para seleccionar la carta deseada. También se ha empezado a crear el esqueleto básico de la escena que saldrá al terminar la partida, para preguntar si se quiere repetir. Supuestamente se deberían gestionar los finales de turno (cada input que avanza la escena, es decir, cada vez que un jugador lanza una carta), los finales de baza (cuando todos los jugadores lanzan una carta) y el final de partida (cuando todos los jugadores han acabado sus cartas). Queda pendiente de probar, que para nada es lo que más problemas me va a llevar :')

(08/05) Se han refinado algunos detalles de las clases, como que los métodos onTouch heredados llamen a la función padre (para actualizar las coordenadas cuando se toca la pantalla en cada frame), solucionado errores de compilación en código (funciones con valores por defecto lo tenían definido en el header y en la implementación) y cambiado flags que se le indican al compilador en el makefile, ya que no permitía lanzar excepciones (se cambió `-fno-exceptions` por `-fexceptions`) ni tampoco implementar polimorfismo en tiempo de ejecución, básico para el funcionamiento del juego (se eliminó `-fno-rtti`). Tras solucionar los errores de compilación se esperaba poder hacer pruebas con el jueguito, pero se encontró un error no visto anteriormente: problemas en el linkeo de los archivos, supuestamente por haber múltiples definiciones de algunas funciones ❓❓. De persistir este error se intentará volver a versiones anteriores sin aplicar polimorfismo o excepciones para obtener una versión "jugable".

(09/05 y 10/05) Se ha creado una nueva rama para conservar la versión que tenía polimorfismo y excepciones y que tras compilar daba problemas de linkeo de archivos.  En la rama de DebugChanges se intentó hacer UnitTest (repito, se intentó) para asegurarse de que la toma de decisiones de la máquina seguía las normas del juego. Al final se encontró un mini error que afectaría a las últimas cartas jugadas, que no se comprobaba si previamente se habían jugado o no. En la rama original se han quitado las clases que usaban polimorfismo y se ha dejado una única clase escena y una única clase que gestiona los inputs. Ahora el proyecto compila y el linker ya genera correctamente los nuevos archivos ejecutables 🙌👼🙌 . Cuando se pueda probar y éste tenga un mínimo de funcionalidad se subirá (POR FIN).



<img src=https://a13xp0p0v.github.io/img/mememe_hold_my_beer.jpg>
<img src=https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQegnDA7k7OnvKQnOxbuPCho8eaFNQs-T2U2A&usqp=CAU>
