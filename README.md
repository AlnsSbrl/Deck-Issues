# Deck Issues
Es un juego de cartas de la baraja espa침ola para Nintendo 3DS desarrollado con DevKitPro en C/C++.
## Instalaci칩n
Existen dos opciones para poder jugar al juego:
- >Se necesita un emulador de 3DS como [Citra](https://citra-emu.org/). Tras instalar y ejecutar el emulador, simplemente se abre el archivo `.3dsx`.
- >De querer jugar en una consola, esta tendr칤a que haber sido modificada siguiendo [estos pasos](https://3ds.hacks.guide/). Tras ello se pone el archivo `.3dsx` en la tarjeta SD en la carpeta `/3ds`. Tras insertar la SD de nuevo en la consola, se podr치 abrir el juego accediendo a 칠l desde el `homebrew launcher`.
- >En el caso de querer modificar el juego, es necesario descargarse las librer칤as de [DevKitPro](https://devkitpro.org/wiki/Getting_Started). Configurando el IDE para detectar dependencias, se podr치n modificar los archivos C/C++ en `source` o los sprites que se emplean en `gfx`, sin olvidar que hay que incluirlos en `gfx\sprites.t3s`. Para compilar el proyecto y generar los archivos para poder jugarlo es necesario usar la `cmd`, situarnos en la carpeta del proyecto y ejecutar el comando `make`. Si todo funciona correctamente se generar치n los archivos necesarios, incluido el archivo `.3dsx` que es el empleado para propiamente jugar al juego. 

## Contenido
Ahora mismo el juego solo dispone de una pantalla. Al abrir el juego se reparten las cartas y se colocan en la pantalla superior ocult치ndolas, si son de la futura IA, o en la pantalla inferior mostrando su valor, si son las del jugador. En todo momento se aseguran que las cartas repartidas no se repiten.

## Actualizaciones: 

(12/04) La jugabilidad no ha cambiado en absoluto. Se ha modularizado completamente el proyecto en clases siguiendo el est치ndar de C++, separando las clases en headers y en archivos cpp. Se han creado los m칠todos b치sicos que seguir치n las clases dentro del juego y se ha modificado el mainLoop del juego para detectar cu치ndo se toca una carta, en teor칤a d치ndole la vuelta, ~~pero esto s칩lo se comprobar치 si funciona cuando se arreglen los errores de compilaci칩n~~ :)

(21/04) Se cre칩 la rama [Debug Changes](https://github.com/AlnsSbrl/Deck-Issues/tree/debug-changes) para situar un proyecto de consola en Visual Studio que se usar치 para encontrar errores de l칩gica.

(23/04) Se hicieron cambios en las clases Jugador y Partida, as칤 como los m칠todos usados al repartir cartas para asegurar que cada jugador tiene 3 cartas y que 칠stas son las mismas (mismo objeto) que las que est치n en la colecci칩n de cartas repartidas en la partida. Estos cambios fueron introducidos porque tras la modularizaci칩n en distintas clases no se pueden apreciar las cartas en pantalla, como s칤 ocurr칤a en el primer commit. Estos cambios parecen no haber afectado en el resultado.

(27/04) Tras haber averiguado que los bugs que imped칤an ver algo por pantalla al ejecutar el archivo `.3dsx` se deb칤an a una f칩rmula y un bucle mal hechos, se ha seguido con el desarrollo de las clases del juego. Se ha introducido la clase base `InputHandler`, que tiene funciones para las distintas combinaciones de teclas que se pretenden emplear en todo el juego. Tambi칠n se ha creado la clase base `Escena`, que tendr치 los contenidos que se quieran representar en esa escena a su disposici칩n. Cada escena tendr치 su inputhandler y se aprovechar치 el polimorfismo para poder ir cambiando de escenas y de mapeos de botones con facilidad.

(02/05) Se han creado dos escenas y dos inputhandlers con el objetivo de tener una pantalla principal que al clickarla (o al pulsar `A` o `START`) nos lleve a una escena donde se repartan las cartas. En esta escena si se pulsa `START` se volver칤an a repartir las cartas, mientras que si se pulsa `B` se volver칤a a la pantalla principal. Esta ser칤a la versi칩n para comprobar la funcionalidad b치sica del juego, pero por un despiste con los includes no se ha podido generar el archivo `.3dsx` para probarlo (la clase `Escena` incluye a `Inputhandler`...pero `Inputhandler` a la vez tambi칠n incluye a `Escena`...:thumbsup::thumbsup:)

(02/05 v2.0 electric boogaloo) Se han expandido las clases que componen el bucle principal del juego, haciendo que los botones del handler avancen la escena, haciendo que cada vez que el usuario presione el bot칩n `A` en la escena de la partida, la IA que tenga el turno realice su acci칩n, mientras que si es el turno del jugador no hace nada. En cambio, si el jugador presiona sobre alguna carta la jugar칤a ~~suponiendo que el onTouch() funcione~~ si y solo si es su turno de jugar, aunque tambi칠n podr칤a usar las teclas de direcci칩n para seleccionar la carta deseada. Tambi칠n se ha empezado a crear el esqueleto b치sico de la escena que saldr치 al terminar la partida, para preguntar si se quiere repetir. Supuestamente se deber칤an gestionar los finales de turno (cada input que avanza la escena, es decir, cada vez que un jugador lanza una carta), los finales de baza (cuando todos los jugadores lanzan una carta) y el final de partida (cuando todos los jugadores han acabado sus cartas). Queda pendiente de probar, que para nada es lo que m치s problemas me va a llevar :')

(08/05) Se han refinado algunos detalles de las clases, como que los m칠todos onTouch heredados llamen a la funci칩n padre (para actualizar las coordenadas cuando se toca la pantalla en cada frame), solucionado errores de compilaci칩n en c칩digo (funciones con valores por defecto lo ten칤an definido en el header y en la implementaci칩n) y cambiado flags que se le indican al compilador en el makefile, ya que no permit칤a lanzar excepciones (se cambi칩 `-fno-exceptions` por `-fexceptions`) ni tampoco implementar polimorfismo en tiempo de ejecuci칩n, b치sico para el funcionamiento del juego (se elimin칩 `-fno-rtti`). Tras solucionar los errores de compilaci칩n se esperaba poder hacer pruebas con el jueguito, pero se encontr칩 un error no visto anteriormente: problemas en el linkeo de los archivos, supuestamente por haber m칰ltiples definiciones de algunas funciones 仇仇. De persistir este error se intentar치 volver a versiones anteriores sin aplicar polimorfismo o excepciones para obtener una versi칩n "jugable".

(09/05 y 10/05) Se ha creado una nueva rama para conservar la versi칩n que ten칤a polimorfismo y excepciones y que tras compilar daba problemas de linkeo de archivos.  En la rama de DebugChanges se intent칩 hacer UnitTest (repito, se intent칩) para asegurarse de que la toma de decisiones de la m치quina segu칤a las normas del juego. Al final se encontr칩 un mini error que afectar칤a a las 칰ltimas cartas jugadas, que no se comprobaba si previamente se hab칤an jugado o no. En la rama original se han quitado las clases que usaban polimorfismo y se ha dejado una 칰nica clase escena y una 칰nica clase que gestiona los inputs. Ahora el proyecto compila y el linker ya genera correctamente los nuevos archivos ejecutables 游뗿游높游뗿 . Cuando se pueda probar y 칠ste tenga un m칤nimo de funcionalidad se subir치 (POR FIN).



<img src=https://a13xp0p0v.github.io/img/mememe_hold_my_beer.jpg>
<img src=https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQegnDA7k7OnvKQnOxbuPCho8eaFNQs-T2U2A&usqp=CAU>
